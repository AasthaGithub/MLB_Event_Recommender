# -*- coding: utf-8 -*-
"""SimpleCCML.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1IAnz8WyzPwGeBm_Xbtmp_1y_KCx_5lmE
"""


"""
Dependencies: sklearn,pandas,pickle
"""
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.naive_bayes import MultinomialNB
from sklearn.linear_model import SGDClassifier
from sklearn.model_selection import train_test_split
import pandas as pd

df = pd.read_csv('Domains1.csv')

# Train -Test Split of data
train_x, test_x, train_y, test_y = train_test_split(df['Event title'], df['Domain'], test_size=0.2,random_state=11)

from sklearn.pipeline import Pipeline
# text_clf = Pipeline([('vect', CountVectorizer()),('tfidf', TfidfTransformer()),('clf', MultinomialNB())])
text_clf = Pipeline([('vect', CountVectorizer()),('tfidf', TfidfTransformer()),('clf-svm', SGDClassifier(loss='hinge', penalty='l2',alpha=1e-3, random_state=11)),])
text_clf = text_clf.fit(train_x, train_y)

import numpy as np
predicted = text_clf.predict(test_x)
np.mean(predicted == test_y)

import pickle

# Save to file in the current working directory
pkl_filename = "pickle_event_domain_model.pkl"
with open(pkl_filename, 'wb') as file:
    pickle.dump(text_clf, file)

# Load from file
with open(pkl_filename, 'rb') as file:
    pickle_model = pickle.load(file)
    
# Calculate the accuracy score and predict target values
score = pickle_model.score(test_x, test_y)
print("Test score: {0:.2f} %".format(100 * score))
Ypredict = pickle_model.predict(test_x)

"""
This is a file to predict domains of any event given its Title as Input
MLB & SGD classifier Approaches were tried on the training Set Domains1.csv
& found out SGD works better , getting more accurate results; hence SGD text classifier was built & finalized.
"""

